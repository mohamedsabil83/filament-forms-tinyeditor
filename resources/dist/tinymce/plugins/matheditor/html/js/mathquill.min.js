(function(){function w(){}function t(n){var t=bt.call(arguments,1);return function(){return n.apply(this,t)}}function v(n,t){if(!t)throw new Error("prayer failed: "+n);}function k(n){v("a direction was passed",n===i||n===u)}function oi(n,t,r,f){function p(){a=pt;var n=e.selection?"$"+e.selection.latex()+"$":"";v.select(n)}var y=n.contents().detach(),e,h,o,a,c,b,v;if(r||n.addClass("mathquill-rendered-math"),t.jQ=n.attr(l,t.id),t.revert=function(){n.empty().unbind(".mathquill").removeClass("mathquill-rendered-math mathquill-editable mathquill-textbox").append(y)},e=t.cursor=gi(t),t.renderLatex(y.text()),h=t.textarea=s('<span class="textarea"><textarea><\/textarea><\/span>'),o=h.children(),t.selectionChanged=function(){a===pt&&(a=setTimeout(p));si(n[0])},n.bind("selectstart.mathquill",function(n){n.target!==o[0]&&n.preventDefault();n.stopPropagation()}),b=e.blink,n.bind("mousedown.mathquill",function(t){function r(n){return e.seek(s(n.target),n.pageX,n.pageY),(e[i]!==c[i]||e.parent!==c.parent)&&e.selectFrom(c),!1}function l(n){return delete n.target,r(n)}function a(t){c=pt;e.blink=b;e.selection||(f?e.show():h.detach());n.unbind("mousemove",r);s(t.target.ownerDocument).unbind("mousemove",l).unbind("mouseup",a)}return o.focus(),setTimeout(function(){o.focus()}),e.blink=w,e.seek(s(t.target),t.pageX,t.pageY),c=kt(e.parent,e[i],e[u]),f||n.prepend(h),n.mousemove(r),s(t.target.ownerDocument).mousemove(l).mouseup(a),!1}),!f){v=ei(o,{container:n});n.bind("cut paste",!1).bind("copy",p).prepend('<span class="selectable">$'+t.latex()+"$<\/span>");o.blur(function(){e.clearSelection();setTimeout(k)});function k(){h.detach()}return}v=ei(o,{container:n,key:function(n,t){e.parent.bubble("onKey",n,t)},text:function(n){e.parent.bubble("onText",n)},cut:function(n){e.selection&&setTimeout(function(){e.prepareEdit();e.parent.bubble("redraw")});n.stopPropagation()},paste:function(n){n=n.slice(0,1)==="$"&&n.slice(-1)==="$"?n.slice(1,-1):"\\text{"+n+"}";e.writeLatex(n).show()}});n.prepend(h);n.addClass("mathquill-editable");r&&n.addClass("mathquill-textbox");o.focus(function(n){e.parent||e.insAtRightEnd(t);e.parent.jQ.addClass("hasCursor");e.selection?(e.selection.jQ.removeClass("blur"),setTimeout(t.selectionChanged)):e.show();n.stopPropagation()}).blur(function(n){e.hide().parent.blur();e.selection&&e.selection.jQ.addClass("blur");n.stopPropagation()});n.bind("focus.mathquill blur.mathquill",function(n){o.trigger(n)}).blur()}function it(n,t,i){return f(yt,{ctrlSeq:n,htmlTemplate:"<"+t+" "+i+">&0<\/"+t+">"})}var g=window.jQuery,pt,fi="mathquill-command-id",l="mathquill-block-id",wt=Math.min,nr=Math.max,bt=[].slice,f=function(n,t,i){function u(n){return typeof n=="object"}function r(n){return typeof n=="function"}function f(){}function e(o,s){function h(){var n=new a;return r(n.init)&&n.init.apply(n,arguments),n}function a(){}s===i&&(s=o,o=Object);h.Bare=a;var v=f[n]=o[n],l=a[n]=h[n]=new f,c;return l.constructor=h,h.mixin=function(t){return a[n]=h[n]=e(h,t)[n],h},(h.open=function(n){if(c={},r(n)?c=n.call(h,l,v,h,o):u(n)&&(c=n),u(c))for(var i in c)t.call(c,i)&&(l[i]=c[i]);return r(l.init)||(l.init=o),h})(s)}return e}("prototype",{}.hasOwnProperty),ei=function(){function t(t){var u=t.which||t.keyCode,f=n[u],r,i=[];return(t.ctrlKey&&i.push("Ctrl"),t.originalEvent&&t.originalEvent.metaKey&&i.push("Meta"),t.altKey&&i.push("Alt"),t.shiftKey&&i.push("Shift"),r=f||String.fromCharCode(u),!i.length&&!f)?r:(i.push(r),i.join("-"))}var n={8:"Backspace",9:"Tab",10:"Enter",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Esc",32:"Spacebar",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",45:"Insert",46:"Del",144:"NumLock"};return function(n,i){function h(n){e=n;clearTimeout(o);o=setTimeout(n)}function b(n){e();e=w;clearTimeout(o);r.val(n);n&&r[0].select()}function k(){var n=r[0];return("selectionStart"in n)?n.selectionStart!==n.selectionEnd:!1}function c(n){var t=r.val();r.val("");t&&n(t)}function l(){v(t(u),u)}function d(n){u=n;f=null;l()}function nt(n){u&&f&&l();f=n;h(tt)}function tt(){k()||c(a)}function it(){u=f=null}function rt(){r.focus();h(ut)}function ut(){c(y)}var u=null,f=null;i||(i={});var a=i.text||w,v=i.key||w,y=i.paste||w,p=i.cut||w,r=g(n),s=g(i.container||r),e=w,o;return s.bind("keydown keypress input keyup focusout paste",function(){e()}),s.bind({keydown:d,keypress:nt,focusout:it,cut:p,paste:rt}),{select:b}}}(),o=f(function(n,t,i){function f(n,t){n=n?"'"+n+"'":"EOF";throw"Parse Error: "+t+" at "+n;}n.init=function(n){this._=n};n.parse=function(n){function t(n,t){return t}return this.skip(e)._(n,t,f)};n.or=function(n){v("or is passed a parser",n instanceof i);var t=this;return i(function(i,r,u){function f(){return n._(i,r,u)}return t._(i,r,f)})};n.then=function(n){var t=this;return i(function(r,u,f){function e(t,r){var e=n instanceof i?n:n(r);return v("a parser is returned",e instanceof i),e._(t,u,f)}return t._(r,e,f)})};n.many=function(){var n=this;return i(function(t,i){function u(n,i){return t=n,r.push(i),!0}function f(){return!1}for(var r=[];n._(t,u,f););return i(t,r)})};n.times=function(n,t){arguments.length<2&&(t=n);var r=this;return i(function(i,u,f){function c(n,t){return s.push(t),i=n,!0}function l(n,t){return h=t,i=n,!1}function a(){return!1}for(var s=[],e=!0,h,o=0;o<n;o+=1)if(e=r._(i,c,l),!e)return f(i,h);for(;o<t&&e;o+=1)e=r._(i,c,a);return u(i,s)})};n.result=function(n){return this.then(u(n))};n.atMost=function(n){return this.times(0,n)};n.atLeast=function(n){var t=this;return t.times(n).then(function(n){return t.many().map(function(t){return n.concat(t)})})};n.map=function(n){return this.then(function(t){return u(n(t))})};n.skip=function(n){return this.then(function(t){return n.result(t)})};var o=this.string=function(n){var t=n.length,r="expected '"+n+"'";return i(function(i,u,f){var e=i.slice(0,t);return e===n?u(i.slice(t),e):f(i,r)})},r=this.regex=function(n){v("regexp parser is anchored",n.toString().charAt(1)==="^");var t="expected "+n;return i(function(i,r,u){var e=n.exec(i),f;return e?(f=e[0],r(i.slice(f.length),f)):u(i,t)})},u=i.succeed=function(n){return i(function(t,i){return i(t,n)})},s=i.fail=function(n){return i(function(t,i,r){return r(t,n)})},h=i.letter=r(/^[a-z]/i),c=i.letters=r(/^[a-z]*/i),l=i.digit=r(/^[0-9]/),a=i.digits=r(/^[0-9]*/),y=i.whitespace=r(/^\s+/),p=i.optWhitespace=r(/^\s*/),w=i.any=i(function(n,t,i){return n?t(n.slice(1),n.charAt(0)):i(n,"expected any character")}),b=i.all=i(function(n,t){return t("",n)}),e=i.eof=i(function(n,t,i){return n?i(n,"expected EOF"):t(n,n)})}),i=-1,u=1,s=f(g,function(n){n.insDirOf=function(n,t){return n===i?this.insertBefore(t.first()):this.insertAfter(t.last())};n.insAtDirEnd=function(n,t){return n===i?this.prependTo(t):this.appendTo(t)}}),kt=f(function(n){n.parent=0;n[i]=0;n[u]=0;n.init=function(n,t,r){this.parent=n;this[i]=t;this[u]=r}}),dt=f(function(n){n[i]=0;n[u]=0;n.parent=0;n.init=function(){this.ends={};this.ends[i]=0;this.ends[u]=0};n.children=function(){return lt(this.ends[i],this.ends[u])};n.eachChild=function(n){return this.children().each(n)};n.foldChildren=function(n,t){return this.children().fold(n,t)};n.adopt=function(n,t,i){return lt(this,this).adopt(n,t,i),this};n.disown=function(){return lt(this,this).disown(),this}}),lt=f(function(n){function t(n,t,r){v("a parent is always present",n);v("leftward is properly set up",function(){return t?t[u]===r&&t.parent===n:n.ends[i]===r}());v("rightward is properly set up",function(){return r?r[i]===t&&r.parent===n:n.ends[u]===t}())}n.init=function(n,t){(v("no half-empty fragments",!n==!t),this.ends={},n)&&(v("left end node is passed to Fragment",n instanceof dt),v("right end node is passed to Fragment",t instanceof dt),v("leftEnd and rightEnd have the same parent",n.parent===t.parent),this.ends[i]=n,this.ends[u]=t)};n.adopt=function(n,r,f){var e,o,s;return(t(n,r,f),e=this,e.disowned=!1,o=e.ends[i],!o)?this:(s=e.ends[u],r||(n.ends[i]=o),f?f[i]=s:n.ends[u]=s,e.ends[u][u]=f,e.each(function(t){t[i]=r;t.parent=n;r&&(r[u]=t);r=t}),e)};n.disown=function(){var f=this,n=f.ends[i],r,e;return!n||f.disowned?f:(f.disowned=!0,r=f.ends[u],e=n.parent,t(e,n[i],n),t(e,r,r[u]),n[i]?n[i][u]=r[u]:e.ends[i]=r[u],r[u]?r[u][i]=n[i]:e.ends[u]=n[i],f)};n.each=function(n){var t=this,r=t.ends[i];if(!r)return t;for(;r!==t.ends[u][u];r=r[u])if(n.call(t,r)===!1)break;return t};n.fold=function(n,t){return this.each(function(i){n=t.call(this,n,i)}),n}}),li=function(){var n=0;return function(){return n+=1}}(),h=f(dt,function(n,t){n.init=function(){t.init.call(this);this.id=li();h[this.id]=this};n.toString=function(){return"[MathElement "+this.id+"]"};n.bubble=function(n){for(var i,r=bt.call(arguments,1),t=this;t;t=t.parent)if(i=t[n]&&t[n].apply(t,r),i===!1)break;return this};n.postOrder=function(n){var i=bt.call(arguments,1),t;typeof n=="string"&&(t=n,n=function(n){t in n&&n[t].apply(n,i)}),function r(t){t.eachChild(r);n(t)}(this)};n.jQ=s();n.jQadd=function(n){this.jQ=this.jQ.add(n)};this.jQize=function(n){var t=s(n);return t.find("*").andSelf().each(function(){var n=s(this),t=n.attr("mathquill-command-id"),i=n.attr("mathquill-block-id");t&&h[t].jQadd(n);i&&h[i].jQadd(n)}),t};n.finalizeInsert=function(){var n=this;n.postOrder("finalizeTree");n.postOrder("blur");n.postOrder("respace");n[u].respace&&n[u].respace();n[i].respace&&n[i].respace();n.postOrder("redraw");n.bubble("redraw")}}),c=f(h,function(n,t){n.init=function(n,i,r){var u=this;t.init.call(u);u.ctrlSeq||(u.ctrlSeq=n);i&&(u.htmlTemplate=i);r&&(u.textTemplate=r)};n.replaces=function(n){n.disown();this.replacedFragment=n};n.isEmpty=function(){return this.foldChildren(!0,function(n,t){return n&&t.isEmpty()})};n.parser=function(){var t=tt.block,n=this;return t.times(n.numBlocks()).map(function(t){n.blocks=t;for(var i=0;i<t.length;i+=1)t[i].adopt(n,n.ends[u],0);return n})};n.createLeftOf=function(n){var t=this,r=t.replacedFragment;t.createBlocks();h.jQize(t.html());r&&(r.adopt(t.ends[i],0,0),r.jQ.appendTo(t.ends[i].jQ));n.jQ.before(t.jQ);n[i]=t.adopt(n.parent,n[i],n[u]);t.finalizeInsert(n);t.placeCursor(n)};n.createBlocks=function(){for(var r,n=this,i=n.numBlocks(),f=n.blocks=Array(i),t=0;t<i;t+=1)r=f[t]=p(),r.adopt(n,n.ends[u],0)};n.respace=w;n.placeCursor=function(n){n.insAtRightEnd(this.foldChildren(this.ends[i],function(n,t){return n.isEmpty()?n:t}))};n.remove=function(){return this.disown(),this.jQ.remove(),this.postOrder(function(n){delete h[n.id]}),this};n.numBlocks=function(){var n=this.htmlTemplate.match(/&\d+/g);return n?n.length:0};n.html=function(){var u=this,f=u.blocks,e=" mathquill-command-id="+u.id,t=u.htmlTemplate.match(/<[^<>]+>|[^<>]+/g),i,n,r;for(v("no unmatched angle brackets",t.join("")===this.htmlTemplate),i=0,n=t[0];n;i+=1,n=t[i])if(n.slice(-2)==="/>")t[i]=n.slice(0,-2)+e+"/>";else if(n.charAt(0)==="<"){v("not an unmatched top-level close tag",n.charAt(1)!=="/");t[i]=n.slice(0,-1)+e+">";r=1;do i+=1,n=t[i],v("no missing close tags",n),n.slice(0,2)==="<\/"?r-=1:n.charAt(0)==="<"&&n.slice(-2)!=="/>"&&(r+=1);while(r>0)}return t.join("").replace(/>&(\d+)/g,function(n,t){return" mathquill-block-id="+f[t].id+">"+f[t].join("html")})};n.latex=function(){return this.foldChildren(this.ctrlSeq,function(n,t){return n+"{"+(t.latex()||" ")+"}"})};n.textTemplate=[""];n.text=function(){var n=this,t=0;return n.foldChildren(n.textTemplate[t],function(i,r){t+=1;var u=r.text();return i&&n.textTemplate[t]==="("&&u[0]==="("&&u.slice(-1)===")"?i+u.slice(1,-1)+n.textTemplate[t]:i+r.text()+(n.textTemplate[t]||"")})}}),d=f(c,function(n,t){n.init=function(n,i,r){r||(r=n&&n.length>1?n.slice(1):n);t.init.call(this,n,i,[r])};n.parser=function(){return o.succeed(this)};n.numBlocks=function(){return 0};n.replaces=function(n){n.remove()};n.createBlocks=w;n.latex=function(){return this.ctrlSeq};n.text=function(){return this.textTemplate};n.placeCursor=w;n.isEmpty=function(){return!0}}),p=f(h,function(t){t.join=function(n){return this.foldChildren("",function(t,i){return t+i[n]()})};t.latex=function(){return this.join("latex")};t.text=function(){return this.ends[i]===this.ends[u]?this.ends[i].text():"("+this.join("text")+")"};t.isEmpty=function(){return this.ends[i]===0&&this.ends[u]===0};t.write=function(t,i,u){var f;f=i.match(/^[a-eg-zA-Z]$/)?a(i):(f=y[i]||n[i])?f(i):r(i);u&&f.replaces(u);f.createLeftOf(t)};t.focus=function(){return this.jQ.addClass("hasCursor"),this.jQ.removeClass("empty"),this};t.blur=function(){return this.jQ.removeClass("hasCursor"),this.isEmpty()&&this.jQ.addClass("empty"),this}}),at=f(lt,function(n,t){n.init=function(n,i){t.init.call(this,n,i||n);this.jQ=this.fold(s(),function(n,t){return t.jQ.add(n)})};n.latex=function(){return this.fold("",function(n,t){return n+t.latex()})};n.remove=function(){return this.jQ.remove(),this.each(function(n){n.postOrder(function(n){delete h[n.id]})}),this.disown()}}),ot=f(p,function(n,t){n.latex=function(){return t.latex.call(this).replace(/(\\[a-z]+) (?![a-z])/ig,"$1")};n.text=function(){return this.foldChildren("",function(n,t){return n+t.text()})};n.renderLatex=function(n){var t=this.jQ;t.children().slice(1).remove();this.ends[i]=this.ends[u]=0;delete this.cursor.selection;this.cursor.insAtRightEnd(this).writeLatex(n)};n.onKey=function(n,t){var r;switch(n){case"Ctrl-Shift-Backspace":case"Ctrl-Backspace":while(this.cursor[i]||this.cursor.selection)this.cursor.backspace();break;case"Shift-Backspace":case"Backspace":this.cursor.backspace();break;case"Esc":case"Tab":case"Spacebar":if(r=this.cursor.parent,r===this.cursor.root){n==="Spacebar"&&t.preventDefault();return}this.cursor.prepareMove();r[u]?this.cursor.insAtLeftEnd(r[u]):this.cursor.insRightOf(r.parent);break;case"Shift-Tab":case"Shift-Esc":case"Shift-Spacebar":if(r=this.cursor.parent,r===this.cursor.root){n==="Shift-Spacebar"&&t.preventDefault();return}this.cursor.prepareMove();r[i]?this.cursor.insAtRightEnd(r[i]):this.cursor.insLeftOf(r.parent);break;case"Enter":break;case"End":this.cursor.prepareMove().insAtRightEnd(this.cursor.parent);break;case"Ctrl-End":this.cursor.prepareMove().insAtRightEnd(this);break;case"Shift-End":while(this.cursor[u])this.cursor.selectRight();break;case"Ctrl-Shift-End":while(this.cursor[u]||this.cursor.parent!==this)this.cursor.selectRight();break;case"Home":this.cursor.prepareMove().insAtLeftEnd(this.cursor.parent);break;case"Ctrl-Home":this.cursor.prepareMove().insAtLeftEnd(this);break;case"Shift-Home":while(this.cursor[i])this.cursor.selectLeft();break;case"Ctrl-Shift-Home":while(this.cursor[i]||this.cursor.parent!==this)this.cursor.selectLeft();break;case"Left":this.cursor.moveLeft();break;case"Shift-Left":this.cursor.selectLeft();break;case"Ctrl-Left":break;case"Right":this.cursor.moveRight();break;case"Shift-Right":this.cursor.selectRight();break;case"Ctrl-Right":break;case"Up":this.cursor.moveUp();break;case"Down":this.cursor.moveDown();break;case"Shift-Up":if(this.cursor[i])while(this.cursor[i])this.cursor.selectLeft();else this.cursor.selectLeft();case"Shift-Down":if(this.cursor[u])while(this.cursor[u])this.cursor.selectRight();else this.cursor.selectRight();case"Ctrl-Up":break;case"Ctrl-Down":break;case"Ctrl-Shift-Del":case"Ctrl-Del":while(this.cursor[u]||this.cursor.selection)this.cursor.deleteForward();break;case"Shift-Del":case"Del":this.cursor.deleteForward();break;case"Meta-A":case"Ctrl-A":if(this!==this.cursor.root)return;for(this.cursor.prepareMove().insAtRightEnd(this);this.cursor[i];)this.cursor.selectLeft();break;default:return!1}return t.preventDefault(),!1};n.onText=function(n){return this.cursor.write(n),!1}}),gt=f(c,function(n,t){n.init=function(n){t.init.call(this,"$");this.cursor=n};n.htmlTemplate='<span class="mathquill-rendered-math">&0<\/span>';n.createBlocks=function(){this.ends[i]=this.ends[u]=ot();this.blocks=[this.ends[i]];this.ends[i].parent=this;this.ends[i].cursor=this.cursor;this.ends[i].write=function(n,t,f){t!=="$"?p.prototype.write.call(this,n,t,f):this.isEmpty()?(n.insRightOf(this.parent).backspace().show(),r("\\$","$").createLeftOf(n)):n[u]?n[i]?p.prototype.write.call(this,n,t,f):n.insLeftOf(this.parent):n.insRightOf(this.parent)}};n.latex=function(){return"$"+this.ends[i].latex()+"$"}}),ai=f(p,function(n){n.renderLatex=function(n){var t=this,e=t.cursor,f,a;t.jQ.children().slice(1).remove();t.ends[i]=t.ends[u]=0;delete e.selection;e.show().insAtRightEnd(t);var v=o.regex,s=o.string,l=o.eof,y=o.all,p=s("$").then(tt).skip(s("$").or(l)).map(function(n){var t=gt(e),r;return t.createBlocks(),r=t.ends[i],n.children().adopt(r,0,0),t}),w=s("\\$").result("$"),b=w.or(v(/^[^$]/)).map(r),k=p.or(b).many(),c=k.skip(l).or(y.result(!1)).parse(n);if(c){for(f=0;f<c.length;f+=1)c[f].adopt(t,t.ends[u],0);a=t.join("html");h.jQize(a).appendTo(t.jQ);this.finalizeInsert()}};n.onKey=function(n){n!=="Spacebar"&&n!=="Shift-Spacebar"&&ot.prototype.onKey.apply(this,arguments)};n.onText=ot.prototype.onText;n.write=function(n,t,i){if(i&&i.remove(),t==="$")gt(n).createLeftOf(n);else{var u;t==="<"?u="&lt;":t===">"&&(u="&gt;");r(t,u).createLeftOf(n)}}}),y={},n={},ft,si=w,vi=document.createElement("div"),hi=vi.style,ni,ti,nt,b,ht,ii,vt,ri,a,r,et,rt,e,ct,ut,ui;for(ti in{transform:1,WebkitTransform:1,MozTransform:1,OTransform:1,msTransform:1})if(ti in hi){ni=ti;break}ni?ft=function(n,t,i){n.css(ni,"scale("+t+","+i+")")}:"filter"in hi?(si=function(n){n.className=n.className},ft=function(n,t,i){function r(){n.css("marginRight",(u.width()-1)*(t-1)/t+"px")}var u,f;t/=1+(i-1)/2;n.css("fontSize",i+"em");n.hasClass("matrixed-container")||n.addClass("matrixed-container").wrapInner('<span class="matrixed"><\/span>');u=n.children().css("filter","progid:DXImageTransform.Microsoft.Matrix(M11="+t+",SizingMethod='auto expand')");r();f=setInterval(r);s(window).load(function(){clearTimeout(f);r()})}):ft=function(n,t,i){n.css("fontSize",i+"em")};nt=f(c,function(n,t){n.init=function(n,i,r){t.init.call(this,n,"<"+i+" "+r+">&0<\/"+i+">")}});n.mathrm=t(nt,"\\mathrm","span",'class="roman font"');n.mathit=t(nt,"\\mathit","i",'class="font"');n.mathbf=t(nt,"\\mathbf","b",'class="font"');n.mathsf=t(nt,"\\mathsf","span",'class="sans-serif font"');n.mathtt=t(nt,"\\mathtt","span",'class="monospace font"');n.underline=t(nt,"\\underline","span",'class="non-leaf underline"');n.overline=n.bar=t(nt,"\\overline","span",'class="non-leaf overline"');b=f(c,function(n,t){n.init=function(n,i,r){t.init.call(this,n,"<"+i+' class="non-leaf">&0<\/'+i+">",[r])};n.finalizeTree=function(){function n(n){var i=this.parent,t=n;do{if(t[u])return n.insLeftOf(i),!1;t=t.parent.parent}while(t!==i);return n.insRightOf(i),!1}v("SupSub is only _ and ^",this.ctrlSeq==="^"||this.ctrlSeq==="_");this.ctrlSeq==="_"?(this.down=this.ends[i],this.ends[i].up=n):(this.up=this.ends[i],this.ends[i].down=n)};n.latex=function(){var n=this.ends[i].latex();return n.length===1?this.ctrlSeq+n:this.ctrlSeq+"{"+(n||" ")+"}"};n.redraw=function(){this[i]&&this[i].respace();this[i]instanceof b||(this.respace(),!this[u]||this[u]instanceof b||this[u].respace())};n.respace=function(){if(this[i].ctrlSeq==="\\int "||this[i]instanceof b&&this[i].ctrlSeq!=this.ctrlSeq&&this[i][i]&&this[i][i].ctrlSeq==="\\int "?this.limit||(this.limit=!0,this.jQ.addClass("limit")):this.limit&&(this.limit=!1,this.jQ.removeClass("limit")),this.respaced=this[i]instanceof b&&this[i].ctrlSeq!=this.ctrlSeq&&!this[i].respaced,this.respaced){var n=+this.jQ.css("fontSize").slice(0,-2),t=this[i].jQ.outerWidth(),r=this.jQ.outerWidth();this.jQ.css({left:(this.limit&&this.ctrlSeq==="_"?-.25:0)-t/n+"em",marginRight:.1-wt(r,t)/n+"em"})}else this.limit&&this.ctrlSeq==="_"?this.jQ.css({left:"-.25em",marginRight:""}):this.jQ.css({left:"",marginRight:""});return this[u]instanceof b&&this[u].respace(),this}});n.subscript=n._=t(b,"_","sub","_");n.superscript=n.supscript=n["^"]=t(b,"^","sup","**");var yi=n.frac=n.dfrac=n.cfrac=n.fraction=f(c,function(n){n.ctrlSeq="\\frac";n.htmlTemplate='<span class="fraction non-leaf"><span class="numerator">&0<\/span><span class="denominator">&1<\/span><span style="display:inline-block;width:0">&nbsp;<\/span><\/span>';n.textTemplate=["(","/",")"];n.finalizeTree=function(){this.up=this.ends[u].up=this.ends[i];this.down=this.ends[i].down=this.ends[u]}}),pi=n.over=y["/"]=f(yi,function(n,t){n.createLeftOf=function(n){if(!this.replacedFragment){for(var r=n[i];r&&!(r instanceof e||r instanceof yt||r instanceof ut||",;:".split("").indexOf(r.ctrlSeq)>-1);)r=r[i];r instanceof ut&&r[u]instanceof b&&(r=r[u],r[u]instanceof b&&r[u].ctrlSeq!=r.ctrlSeq&&(r=r[u]));r!==n[i]&&(this.replaces(at(r[u]||n.parent.ends[i],n[i])),n[i]=r)}t.createLeftOf.call(this,n)}}),wi=n.sqrt=n["âˆš"]=f(c,function(n,t){n.ctrlSeq="\\sqrt";n.htmlTemplate='<span class="non-leaf"><span class="scaled sqrt-prefix">&radic;<\/span><span class="non-leaf sqrt-stem">&0<\/span><\/span>';n.textTemplate=["sqrt(",")"];n.parser=function(){return tt.optBlock.then(function(n){return tt.block.map(function(t){var i=bi();return i.blocks=[n,t],n.adopt(i,0,0),t.adopt(i,n,0),i})}).or(t.parser.call(this))};n.redraw=function(){var n=this.ends[u].jQ;ft(n.prev(),1,n.innerHeight()/+n.css("fontSize").slice(0,-2)-.1)}}),tr=n.vec=f(c,function(n){n.ctrlSeq="\\vec";n.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&rarr;<\/span><span class="vector-stem">&0<\/span><\/span>';n.textTemplate=["vec(",")"]}),ir=n.hat=n.hat=f(c,function(n){n.ctrlSeq="\\hat";n.htmlTemplate='<span class="non-leaf"><span class="hat-prefix">&#94;<\/span><span class="vector-stem">&0<\/span><\/span>';n.textTemplate=["hat{","}"]}),rr=n.vech=f(c,function(n){n.ctrlSeq="\\vech";n.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&rightharpoonup;<\/span><span class="vector-stem">&0<\/span><\/span>';n.textTemplate=["vech(",")"]}),ur=n.veclr=f(c,function(n){n.ctrlSeq="\\veclr";n.htmlTemplate='<span class="non-leaf"><span class="vector-prefix">&longleftrightarrow;<\/span><span class="vector-stem">&0<\/span><\/span>';n.textTemplate=["vech(",")"]}),bi=n.nthroot=f(wi,function(n){n.htmlTemplate='<sup class="nthroot non-leaf">&0<\/sup><span class="scaled"><span class="sqrt-prefix scaled">&radic;<\/span><span class="sqrt-stem non-leaf">&1<\/span><\/span>';n.textTemplate=["sqrt[","](",")"];n.latex=function(){return"\\sqrt["+this.ends[i].latex()+"]{"+this.ends[u].latex()+"}"}}),fr=n.contentupdown=f(c,function(n){n.ctrlSeq="\\contentupdown";n.htmlTemplate='<span class="content-block non-leaf"><sub class="content-up">&2<\/sub><span class="content-main">&0<\/span><sup class="content-down">&1<\/sup><\/span>';n.textTemplate=["vec(",")"]}),er=n.contentup=f(c,function(n){n.ctrlSeq="\\contentup";n.htmlTemplate='<span class="content-block non-leaf"><sub class="content-up">&1<\/sub><span class="content-main">&0<\/span><sup class="content-down">&#160<\/sup><\/span>';n.textTemplate=["vec(",")"]}),or=n.contentdown=f(c,function(n){n.ctrlSeq="\\contentdown";n.htmlTemplate='<span class="content-block non-leaf"><sub class="content-up">&#160<\/sub><span class="content-main">&0<\/span><sup class="content-down">&1<\/sup><\/span>';n.textTemplate=["vec(",")"]}),st=f(c,function(n,t){n.init=function(n,i,r,u){t.init.call(this,"\\left"+r,'<span class="non-leaf"><span class="scaled paren">'+n+'<\/span><span class="non-leaf">&0<\/span><span class="scaled paren">'+i+"<\/span><\/span>",[n,i]);this.end="\\right"+u};n.jQadd=function(){t.jQadd.apply(this,arguments);var n=this.jQ;this.bracketjQs=n.children(":first").add(n.children(":last"))};n.latex=function(){return this.ctrlSeq+this.ends[i].latex()+this.end};n.redraw=function(){var n=this.ends[i].jQ,t=n.outerHeight()/+n.css("fontSize").slice(0,-2);ft(this.bracketjQs,wt(1+.2*(t-1),1.2),1.05*t)}});n.left=f(c,function(n){n.parser=function(){var n=o.regex,i=o.string,r=o.succeed,t=o.optWhitespace;return t.then(n(/^(?:[([|]|\\\{)/)).then(function(u){u.charAt(0)==="\\"&&(u=u.slice(1));var f=y[u]();return tt.map(function(n){f.blocks=[n];n.adopt(f,0,0)}).then(i("\\right")).skip(t).then(n(/^(?:[\])|]|\\\})/)).then(function(n){return n.slice(-1)!==f.end.slice(-1)?o.fail("open doesn't match close"):r(f)})})}});n.right=f(c,function(n){n.parser=function(){return o.fail("unmatched \\right")}});n.lbrace=y["{"]=t(st,"{","}","\\{","\\}");n.langle=n.lang=t(st,"&lang;","&rang;","\\langle ","\\rangle ");ht=f(st,function(n,t){n.createLeftOf=function(n){n[u]||!n.parent.parent||n.parent.parent.end!==this.end||this.replacedFragment?t.createLeftOf.call(this,n):n.insRightOf(n.parent.parent)};n.placeCursor=function(n){this.ends[i].blur();n.insRightOf(this)}});n.rbrace=y["}"]=t(ht,"{","}","\\{","\\}");n.rangle=n.rang=t(ht,"&lang;","&rang;","\\langle ","\\rangle ");ii=function(n,t){n.init=function(n,i){t.init.call(this,n,i,n,i)}};vt=f(st,ii);n.lparen=y["("]=t(vt,"(",")");n.lbrack=n.lbracket=y["["]=t(vt,"[","]");ri=f(ht,ii);n.rparen=y[")"]=t(ri,"(",")");n.rbrack=n.rbracket=y["]"]=t(ri,"[","]");var sr=n.lpipe=n.rpipe=y["|"]=f(vt,function(n,t){n.init=function(){t.init.call(this,"|","|")};n.createLeftOf=ht.prototype.createLeftOf}),yt=y.$=n.text=n.textnormal=n.textrm=n.textup=n.textmd=f(c,function(n,t){n.ctrlSeq="\\text";n.htmlTemplate='<span class="text">&0<\/span>';n.replaces=function(n){n instanceof at?this.replacedText=n.remove().jQ.text():typeof n=="string"&&(this.replacedText=n)};n.textTemplate=['"','"'];n.parser=function(){var n=this,t=o.string,f=o.regex,e=o.optWhitespace;return e.then(t("{")).then(f(/^[^}]*/)).skip(t("}")).map(function(t){var e,f,o;for(n.createBlocks(),e=n.ends[i],f=0;f<t.length;f+=1)o=r(t.charAt(f)),o.adopt(e,e.ends[u],0);return n})};n.createBlocks=function(){this.ends[i]=this.ends[u]=ki();this.blocks=[this.ends[i]];this.ends[i].parent=this};n.finalizeInsert=function(){this.ends[i].blur=function(){return delete this.blur,this};t.finalizeInsert.call(this)};n.createLeftOf=function(n){if(t.createLeftOf.call(this,this.cursor=n),this.replacedText)for(var r=0;r<this.replacedText.length;r+=1)this.ends[i].write(n,this.replacedText.charAt(r))}}),ki=f(p,function(n,t){n.onKey=function(n){if(n==="Spacebar"||n==="Shift-Spacebar")return!1};n.deleteOutOf=function(n,t){this.isEmpty()&&t.insRightOf(this.parent)};n.write=function(n,t,f){var o,e;return f&&f.remove(),t!=="$"?(t==="<"?o="&lt;":t===">"&&(o="&gt;"),r(t,o).createLeftOf(n)):this.isEmpty()?(n.insRightOf(this.parent).backspace(),r("\\$","$").createLeftOf(n)):n[u]?n[i]?(e=yt(),e.replaces(at(n[u],this.ends[u])),n.insRightOf(this.parent),e.adopt=function(){delete this.adopt;this.adopt.apply(this,arguments);this[i]=0},e.createLeftOf(n),e[i]=this.parent,n.insLeftOf(e)):n.insLeftOf(this.parent):n.insRightOf(this.parent),!1};n.blur=function(){if(this.jQ.removeClass("hasCursor"),this.isEmpty()){var t=this.parent,n=t.cursor;n.parent===this?this.jQ.addClass("empty"):(n.hide(),t.remove(),n[u]===t?n[u]=t[u]:n[i]===t&&(n[i]=t[i]),n.show().parent.bubble("redraw"))}return this};n.focus=function(){var n,r;if(t.focus.call(this),n=this.parent,n[u].ctrlSeq===n.ctrlSeq){var e=this,r=n.cursor,f=n[u].ends[i];f.eachChild(function(n){n.parent=e;n.jQ.appendTo(e.jQ)});this.ends[u]?this.ends[u][u]=f.ends[i]:this.ends[i]=f.ends[i];f.ends[i][i]=this.ends[u];this.ends[u]=f.ends[u];f.parent.remove();r[i]?r.insRightOf(r[i]):r.insAtLeftEnd(this);r.parent.bubble("redraw")}else n[i].ctrlSeq===n.ctrlSeq&&(r=n.cursor,r[i]?n[i].ends[i].focus():r.insAtRightEnd(n[i].ends[i]));return this}});n.em=n.italic=n.italics=n.emph=n.textit=n.textsl=it("\\textit","i",'class="text"');n.strong=n.bold=n.textbf=it("\\textbf","b",'class="text"');n.sf=n.textsf=it("\\textsf","span",'class="sans-serif text"');n.tt=n.texttt=it("\\texttt","span",'class="monospace text"');n.textsc=it("\\textsc","span",'style="font-variant:small-caps" class="text"');n.uppercase=it("\\uppercase","span",'style="text-transform:uppercase" class="text"');n.lowercase=it("\\lowercase","span",'style="text-transform:lowercase" class="text"');var hr=y["\\"]=f(c,function(n,t){n.ctrlSeq="\\";n.replaces=function(n){this._replacedFragment=n.disown();this.isEmpty=function(){return!1}};n.htmlTemplate='<span class="latex-command-input non-leaf">\\<span>&0<\/span><\/span>';n.textTemplate=["\\"];n.createBlocks=function(){t.createBlocks.call(this);this.ends[i].focus=function(){return this.parent.jQ.addClass("hasCursor"),this.isEmpty()&&this.parent.jQ.removeClass("empty"),this};this.ends[i].blur=function(){return this.parent.jQ.removeClass("hasCursor"),this.isEmpty()&&this.parent.jQ.addClass("empty"),this}};n.createLeftOf=function(n){if(t.createLeftOf.call(this,n),this.cursor=n.insAtRightEnd(this.ends[i]),this._replacedFragment){var u=this.jQ[0];this.jQ=this._replacedFragment.jQ.addClass("blur").bind("mousedown mousemove",function(n){return s(n.target=u).trigger(n),!1}).insertBefore(this.jQ).add(this.jQ)}this.ends[i].write=function(n,t,i){i&&i.remove();t.match(/[a-z]/i)?r(t).createLeftOf(n):(this.parent.renderCommand(),t==="\\"&&this.isEmpty()||this.parent.parent.write(n,t))}};n.latex=function(){return"\\"+this.ends[i].latex()+" "};n.onKey=function(n,t){if(n==="Tab"||n==="Enter"||n==="Spacebar")return this.renderCommand(),t.preventDefault(),!1};n.renderCommand=function(){this.jQ=this.jQ.last();this.remove();this[u]?this.cursor.insLeftOf(this[u]):this.cursor.insAtRightEnd(this.parent);var n=this.ends[i].latex();n||(n="backslash");this.cursor.insertCmd(n,this._replacedFragment)}}),di=n.binom=n.binomial=f(c,function(n){n.ctrlSeq="\\binom";n.htmlTemplate='<span class="paren scaled">(<\/span><span class="non-leaf"><span class="array non-leaf"><span>&0<\/span><span>&1<\/span><\/span><\/span><span class="paren scaled">)<\/span>';n.textTemplate=["choose(",",",")"];n.redraw=function(){var n=this.jQ.eq(1),t=n.outerHeight()/+n.css("fontSize").slice(0,-2),i=this.jQ.filter(".paren");ft(i,wt(1+.2*(t-1),1.2),1.05*t)}}),cr=n.matrix=f(c,function(n){n.ctrlSeq="\\matrix";n.htmlTemplate='<span class="mtable non-leaf"><span class="mtr non-leaf"><span class="mtd"><span>a<\/span><\/span><span class="mtd"><span>b<\/span><\/span><\/span><span class="mtr non-leaf"><span class="mtd"><span>c<\/span><\/span><span class="mtd"><span>d<\/span><\/span><\/span><\/span>';n.latex=function(){for(var r=this.foldChildren([],function(n,t){return n.push(t.latex()),n}),i="\\begin{array}",t=0;t<r.length;t++)t%n.columns==0&&t!=0&&(i+="\\\\"),i+=r[t],(t+1)%n.columns!=0&&(i+="&");return i+"\\end{array}"};n.text=function(){return"["+this.foldChildren([],function(n,t){return n.push(t.text()),n}).join()+"]"};n.setSize=MatrixSize=function(t,i){var r,u,f,e;for(n.columns=i,r='<span class="mtable non-leaf">',u=0,f=0;f<t;f++){for(r+='<span class="mtr non-leaf">',e=0;e<i;e++)r+='<span class="mtd"><span>&'+u+"<\/span><\/span>",u++;r+="<\/span>"}r+="<\/span>";n.htmlTemplate=r};n.parser=function(){return o.succeed(this)}}),lr=n.textbf=f(c,function(n){n.ctrlSeq="\\textbf";n.htmlTemplate='<span class="bold">&0<\/span>';n.latex=function(){for(var t=this.foldChildren([],function(n,t){return n.push(t.latex()),n}),i="\\textbf{",n=0;n<t.length;n++)i+=t[n];return i+"}"}}),ar=n.emph=f(c,function(n){n.ctrlSeq="\\emph";n.htmlTemplate='<span class="italic">&0<\/span>';n.latex=function(){for(var t=this.foldChildren([],function(n,t){return n.push(t.latex()),n}),i="\\emph{",n=0;n<t.length;n++)i+=t[n];return i+"}"}}),vr=n.choose=f(di,function(n){n.createLeftOf=pi.prototype.createLeftOf}),yr=n.vector=f(c,function(n,t){n.ctrlSeq="\\vector";n.htmlTemplate='<span class="array"><span>&0<\/span><\/span>';n.latex=function(){return"\\begin{matrix}"+this.foldChildren([],function(n,t){return n.push(t.latex()),n}).join("\\\\")+"\\end{matrix}"};n.text=function(){return"["+this.foldChildren([],function(n,t){return n.push(t.text()),n}).join()+"]"};n.createLeftOf=function(n){t.createLeftOf.call(this,this.cursor=n)};n.onKey=function(n,t){var r=this.cursor.parent,f;if(r.parent===this){if(n==="Enter")return f=p(),f.parent=this,f.jQ=s("<span><\/span>").attr(l,f.id).insertAfter(r.jQ),r[u]?r[u][i]=f:this.ends[u]=f,f[u]=r[u],r[u]=f,f[i]=r,this.bubble("redraw").cursor.insAtRightEnd(f),t.preventDefault(),!1;if(n!=="Tab"||r[u]){if(t.which===8){if(r.isEmpty())return r[i]?(this.cursor.insAtRightEnd(r[i]),r[i][u]=r[u]):(this.cursor.insLeftOf(this),this.ends[i]=r[u]),r[u]?r[u][i]=r[i]:this.ends[u]=r[i],r.jQ.remove(),this.isEmpty()?this.cursor.deleteForward():this.bubble("redraw"),t.preventDefault(),!1;if(!this.cursor[i])return t.preventDefault(),!1}}else return r.isEmpty()?r[i]?(this.cursor.insRightOf(this),delete r[i][u],this.ends[u]=r[i],r.jQ.remove(),this.bubble("redraw"),t.preventDefault(),!1):void 0:(f=p(),f.parent=this,f.jQ=s("<span><\/span>").attr(l,f.id).appendTo(this.jQ),this.ends[u]=f,r[u]=f,f[i]=r,this.bubble("redraw").cursor.insAtRightEnd(f),t.preventDefault(),!1)}}});n.editable=f(gt,function(n,t){n.init=function(){c.prototype.init.call(this,"\\editable")};n.jQadd=function(){var n=this,r,f;t.jQadd.apply(n,arguments);r=n.ends[i].disown();f=n.jQ.children().detach();n.ends[i]=n.ends[u]=ot();n.blocks=[n.ends[i]];n.ends[i].parent=n;oi(n.jQ,n.ends[i],!1,!0);n.cursor=n.ends[i].cursor;r.children().adopt(n.ends[i],0,0);f.appendTo(n.ends[i].jQ);n.ends[i].cursor.insAtRightEnd(n.ends[i])};n.latex=function(){return this.ends[i].latex()};n.text=function(){return this.ends[i].text()}});n.f=t(d,"f",'<var class="florin">&fnof;<\/var><span style="display:inline-block;width:0">&nbsp;<\/span>');a=f(d,function(n,t){n.init=function(n,i){t.init.call(this,n,"<var>"+(i||n)+"<\/var>")};n.text=function(){var n=this.ctrlSeq;return!this[i]||this[i]instanceof a||this[i]instanceof e||(n="*"+n),!this[u]||this[u]instanceof e||this[u].ctrlSeq==="^"||(n+="*"),n}});r=f(d,function(n,t){n.init=function(n,i){t.init.call(this,n,"<span>"+(i||n)+"<\/span>")}});y[" "]=t(r,"\\:"," ");n.prime=y["'"]=t(r,"'","&prime;");et=f(d,function(n,t){n.init=function(n,i){t.init.call(this,n,'<span class="nonSymbola">'+(i||n)+"<\/span>")}});n["@"]=et;n["&"]=t(et,"\\&","&amp;");n["%"]=t(et,"\\%","%");n.alpha=n.beta=n.gamma=n.delta=n.zeta=n.eta=n.theta=n.iota=n.kappa=n.mu=n.nu=n.xi=n.omicron=n.rho=n.sigma=n.tau=n.chi=n.psi=n.omega=f(a,function(n,t){n.init=function(n){t.init.call(this,"\\"+n+" ","&"+n+";")}});n.phi=t(a,"\\phi ","&#981;");n.phiv=n.varphi=t(a,"\\varphi ","&phi;");n.epsilon=t(a,"\\epsilon ","&#1013;");n.epsiv=n.varepsilon=t(a,"\\varepsilon ","&epsilon;");n.piv=n.varpi=t(a,"\\varpi ","&piv;");n.sigmaf=n.sigmav=n.varsigma=t(a,"\\varsigma ","&sigmaf;");n.thetav=n.vartheta=n.thetasym=t(a,"\\vartheta ","&thetasym;");n.upsilon=n.upsi=t(a,"\\upsilon ","&upsilon;");n.gammad=n.Gammad=n.digamma=t(a,"\\digamma ","&#989;");n.kappav=n.varkappa=t(a,"\\varkappa ","&#1008;");n.rhov=n.varrho=t(a,"\\varrho ","&#1009;");n.pi=n["Ï€"]=t(et,"\\pi ","&pi;");n.lambda=t(et,"\\lambda ","&lambda;");n.Upsilon=n.Upsi=n.upsih=n.Upsih=t(d,"\\Upsilon ",'<var style="font-family: serif">&upsih;<\/var>');n.Alpha=n.Beta=n.Gamma=n.Delta=n.Epsilon=n.Zeta=n.Eta=n.Theta=n.Iota=n.Kappa=n.Lambda=n.Mu=n.Nu=n.Xi=n.Omicron=n.Pi=n.Rho=n.Sigma=n.Tau=n.Phi=n.Chi=n.Psi=n.Omega=n.forall=f(r,function(n,t){n.init=function(n){t.init.call(this,"\\"+n+" ","&"+n+";")}});rt=f(c,function(n){n.init=function(n){this.latex=n};n.createLeftOf=function(n){n.writeLatex(this.latex)};n.parser=function(){var n=tt.parse(this.latex).children();return o.succeed(n)}});n["Â¹"]=t(rt,"^1");n["Â²"]=t(rt,"^2");n["Â³"]=t(rt,"^3");n["Â¼"]=t(rt,"\\frac14");n["Â½"]=t(rt,"\\frac12");n["Â¾"]=t(rt,"\\frac34");e=f(d,function(n,t){n.init=function(n,i,r){t.init.call(this,n,'<span class="binary-operator">'+i+"<\/span>",r)}});ct=f(e,function(n){n.init=r.prototype.init;n.respace=function(){return this.jQ[0].className=this[i]?this[i]instanceof e&&this[u]&&!(this[u]instanceof e)?"unary-operator":"binary-operator":"",this}});n["+"]=t(ct,"+","+");n["â€“"]=n["-"]=t(ct,"-","&minus;");n["Â±"]=n.pm=n.plusmn=n.plusminus=t(ct,"\\pm ","&plusmn;");n.mp=n.mnplus=n.minusplus=t(ct,"\\mp ","&#8723;");y["*"]=n.sdot=n.cdot=t(e,"\\cdot ","&middot;");n["="]=t(e,"=","=");n["<"]=t(e,"<","&lt;");n[">"]=t(e,">","&gt;");n.notin=n.sim=n.cong=n.equiv=n.oplus=n.otimes=f(e,function(n,t){n.init=function(n){t.init.call(this,"\\"+n+" ","&"+n+";")}});n.notequiv=t(e,"\\not\\equiv ","&#8802;");n.times=t(e,"\\times ","&times;","[x]");n["Ã·"]=n.div=n.divide=n.divides=t(e,"\\div ","&divide;","[/]");n["â‰ "]=n.ne=n.neq=t(e,"\\ne ","&ne;");n.ast=n.star=n.loast=n.lowast=t(e,"\\ast ","&lowast;");n.therefor=n.therefore=t(e,"\\therefore ","&there4;");n.cuz=n.because=t(e,"\\because ","&#8757;");n.prop=n.propto=t(e,"\\propto ","&prop;");n["â‰ˆ"]=n.asymp=n.approx=t(e,"\\approx ","&asymp;");n.lt=t(e,"<","&lt;");n.gt=t(e,">","&gt;");n["â‰¤"]=n.le=n.leq=t(e,"\\le ","&le;");n["â‰¥"]=n.ge=n.geq=t(e,"\\ge ","&ge;");n.isin=n["in"]=t(e,"\\in ","&isin;");n.ni=n.contains=t(e,"\\ni ","&ni;");n.notni=n.niton=n.notcontains=n.doesnotcontain=t(e,"\\not\\ni ","&#8716;");n.notsim=t(e,"\\not\\sim ","&#8769;");n.neq=t(e,"\\neq ","&#8800;");n.lneq=t(e,"\\lneq ","&#10887;");n.gneq=t(e,"\\gneq ","&#10888;");n.sub=n.subset=t(e,"\\subset ","&sub;");n.sup=n.supset=n.superset=t(e,"\\supset ","&sup;");n.nsub=n.notsub=n.nsubset=n.notsubset=t(e,"\\not\\subset ","&#8836;");n.nsup=n.notsup=n.nsupset=n.notsupset=n.nsuperset=n.notsuperset=t(e,"\\not\\supset ","&#8837;");n.sube=n.subeq=n.subsete=n.subseteq=t(e,"\\subseteq ","&sube;");n.supe=n.supeq=n.supsete=n.supseteq=n.supersete=n.superseteq=t(e,"\\supseteq ","&supe;");n.nsube=n.nsubeq=n.notsube=n.notsubeq=n.nsubsete=n.nsubseteq=n.notsubsete=n.notsubseteq=t(e,"\\not\\subseteq ","&#8840;");n.nsupe=n.nsupeq=n.notsupe=n.notsupeq=n.nsupsete=n.nsupseteq=n.notsupsete=n.notsupseteq=n.nsupersete=n.nsuperseteq=n.notsupersete=n.notsuperseteq=t(e,"\\not\\supseteq ","&#8841;");ut=f(d,function(n,t){n.init=function(n,i){t.init.call(this,n,"<big>"+i+"<\/big>")}});n["âˆ‘"]=n.sum=n.summation=t(ut,"\\sum ","&sum;");n["âˆ"]=n.prod=n.product=t(ut,"\\prod ","&prod;");n.coprod=n.coproduct=t(ut,"\\coprod ","&#8720;");n["âˆ«"]=n.int=n.integral=t(ut,"\\int ","&int;");n.N=n.naturals=n.Naturals=t(r,"\\mathbb{N}","&#8469;");n.P=n.primes=n.Primes=n.projective=n.Projective=n.probability=n.Probability=t(r,"\\mathbb{P}","&#8473;");n.Z=n.integers=n.Integers=t(r,"\\mathbb{Z}","&#8484;");n.Q=n.rationals=n.Rationals=t(r,"\\mathbb{Q}","&#8474;");n.R=n.reals=n.Reals=t(r,"\\mathbb{R}","&#8477;");n.C=n.complex=n.Complex=n.complexes=n.Complexes=n.complexplane=n.Complexplane=n.ComplexPlane=t(r,"\\mathbb{C}","&#8450;");n.H=n.Hamiltonian=n.quaternions=n.Quaternions=t(r,"\\mathbb{H}","&#8461;");n.quad=n.emsp=t(r,"\\quad ","    ");n.qquad=t(r,"\\qquad ","        ");n.diamond=t(r,"\\diamond ","&#9671;");n.bigtriangleup=t(r,"\\bigtriangleup ","&#9651;");n.ominus=t(r,"\\ominus ","&#8854;");n.uplus=t(r,"\\uplus ","&#8846;");n.bigtriangledown=t(r,"\\bigtriangledown ","&#9661;");n.sqcap=t(r,"\\sqcap ","&#8851;");n.triangleleft=t(r,"\\triangleleft ","&#9667;");n.sqcup=t(r,"\\sqcup ","&#8852;");n.triangleright=t(r,"\\triangleright ","&#9657;");n.odot=t(r,"\\odot ","&#8857;");n.bigcirc=t(r,"\\bigcirc ","&#9711;");n.dagger=t(r,"\\dagger ","&#0134;");n.ddagger=t(r,"\\ddagger ","&#135;");n.wr=t(r,"\\wr ","&#8768;");n.amalg=t(r,"\\amalg ","&#8720;");n.models=t(r,"\\models ","&#8872;");n.prec=t(r,"\\prec ","&#8826;");n.succ=t(r,"\\succ ","&#8827;");n.preceq=t(r,"\\preceq ","&#8828;");n.succeq=t(r,"\\succeq ","&#8829;");n.simeq=t(r,"\\simeq ","&#8771;");n.mid=t(r,"\\mid ","&#8739;");n.ll=t(r,"\\ll ","&#8810;");n.gg=t(r,"\\gg ","&#8811;");n.parallel=t(r,"\\parallel ","&#8741;");n.bowtie=t(r,"\\bowtie ","&#8904;");n.sqsubset=t(r,"\\sqsubset ","&#8847;");n.sqsupset=t(r,"\\sqsupset ","&#8848;");n.smile=t(r,"\\smile ","&#8995;");n.sqsubseteq=t(r,"\\sqsubseteq ","&#8849;");n.sqsupseteq=t(r,"\\sqsupseteq ","&#8850;");n.doteq=t(r,"\\doteq ","&#8784;");n.frown=t(r,"\\frown ","&#8994;");n.vdash=t(r,"\\vdash ","&#8870;");n.dashv=t(r,"\\dashv ","&#8867;");n.longleftarrow=t(r,"\\longleftarrow ","&#8592;");n.longrightarrow=t(r,"\\longrightarrow ","&#8594;");n.Longleftarrow=t(r,"\\Longleftarrow ","&#8656;");n.Longrightarrow=t(r,"\\Longrightarrow ","&#8658;");n.longleftrightarrow=t(r,"\\longleftrightarrow ","&#8596;");n.updownarrow=t(r,"\\updownarrow ","&#8597;");n.Longleftrightarrow=t(r,"\\Longleftrightarrow ","&#8660;");n.Updownarrow=t(r,"\\Updownarrow ","&#8661;");n.mapsto=t(r,"\\mapsto ","&#8614;");n.leftmapsto=t(r,"\\leftmapsto ","&#8612;");n.nearrow=t(r,"\\nearrow ","&#8599;");n.hookleftarrow=t(r,"\\hookleftarrow ","&#8617;");n.hookrightarrow=t(r,"\\hookrightarrow ","&#8618;");n.searrow=t(r,"\\searrow ","&#8600;");n.leftharpoonup=t(r,"\\leftharpoonup ","&#8636;");n.rightharpoonup=t(r,"\\rightharpoonup ","&#8640;");n.rightbarharpoon=t(r,"\\rightbarharpoon ","&#10605;");n.leftbarharpoon=t(r,"\\leftbarharpoon ","&#10602;");n.swarrow=t(r,"\\swarrow ","&#8601;");n.leftharpoondown=t(r,"\\leftharpoondown ","&#8637;");n.rightharpoondown=t(r,"\\rightharpoondown ","&#8641;");n.nwarrow=t(r,"\\nwarrow ","&#8598;");n.dlsh=t(r,"\\dlsh ","&#8629;");n.ldots=t(r,"\\ldots ","&#8230;");n.cdots=t(r,"\\cdots ","&#8943;");n.vdots=t(r,"\\vdots ","&#8942;");n.upslopeellipsis=t(r,"\\upslopeellipsis ","&#8944;");n.ddots=t(r,"\\ddots ","⋱");n.surd=t(r,"\\surd ","&#8730;");n.triangle=t(r,"\\triangle ","&#9653;");n.ell=t(r,"\\ell ","&#8467;");n.top=t(r,"\\top ","&#8868;");n.flat=t(r,"\\flat ","&#9837;");n.natural=t(r,"\\natural ","&#9838;");n.sharp=t(r,"\\sharp ","&#9839;");n.wp=t(r,"\\wp ","&#8472;");n.bot=t(r,"\\bot ","&#8869;");n.clubsuit=t(r,"\\clubsuit ","&#9827;");n.diamondsuit=t(r,"\\diamondsuit ","&#9826;");n.heartsuit=t(r,"\\heartsuit ","&#9825;");n.spadesuit=t(r,"\\spadesuit ","&#9824;");n.surfintegral=t(r,"\\surfintegral","&#8751;");n.oint=t(r,"\\oint ","&#8750;");n.iint=t(r,"\\iint ","&#8748;");n.iiint=t(r,"\\iiint ","&#8749;");n.volintegral=t(r,"\\volintegral ","&#8752;");n.bigcap=t(r,"\\bigcap ","&#8745;");n.bigcup=t(r,"\\bigcup ","&#8746;");n.bigsqcup=t(r,"\\bigsqcup ","&#8852;");n.bigvee=t(r,"\\bigvee ","&#8744;");n.bigwedge=t(r,"\\bigwedge ","&#8743;");n.bigodot=t(r,"\\bigodot ","&#8857;");n.bigotimes=t(r,"\\bigotimes ","&#8855;");n.bigoplus=t(r,"\\bigoplus ","&#8853;");n.biguplus=t(r,"\\biguplus ","&#8846;");n.lfloor=t(r,"\\lfloor ","&#8970;");n.rfloor=t(r,"\\rfloor ","&#8971;");n.lceil=t(r,"\\lceil ","&#8968;");n.rceil=t(r,"\\rceil ","&#8969;");n.slash=t(r,"\\slash ","&#47;");n.opencurlybrace=t(r,"\\opencurlybrace ","&#123;");n.closecurlybrace=t(r,"\\closecurlybrace ","&#125;");n.caret=t(r,"\\caret ","^");n.underscore=t(r,"\\underscore ","_");n.backslash=t(r,"\\backslash ","\\");n.vert=t(r,"|");n.perp=n.perpendicular=t(r,"\\perp ","&perp;");n.nabla=n.del=t(r,"\\nabla ","&nabla;");n.hbar=t(r,"\\hbar ","&#8463;");n.AA=n.Angstrom=n.angstrom=t(r,"\\text\\AA ","&#8491;");n.ring=n.circ=n.circle=t(r,"\\circ ","&#8728;");n.bull=n.bullet=t(r,"\\bullet ","&bull;");n.setminus=n.smallsetminus=t(r,"\\setminus ","&#8726;");n.not=n["Â¬"]=n.neg=t(r,"\\neg ","&not;");n["â€¦"]=n.dots=n.ellip=n.hellip=n.ellipsis=n.hellipsis=t(r,"\\dots ","&hellip;");n.converges=n.darr=n.dnarr=n.dnarrow=n.downarrow=t(r,"\\downarrow ","&darr;");n.dArr=n.dnArr=n.dnArrow=n.Downarrow=t(r,"\\Downarrow ","&dArr;");n.diverges=n.uarr=n.uparrow=t(r,"\\uparrow ","&uarr;");n.uArr=n.Uparrow=t(r,"\\Uparrow ","&uArr;");n.to=t(e,"\\to ","&rarr;");n.rarr=n.rightarrow=t(r,"\\rightarrow ","&rarr;");n.implies=t(e,"\\Rightarrow ","&rArr;");n.rArr=n.Rightarrow=t(r,"\\Rightarrow ","&rArr;");n.gets=t(e,"\\gets ","&larr;");n.larr=n.leftarrow=t(r,"\\leftarrow ","&larr;");n.impliedby=t(e,"\\Leftarrow ","&lArr;");n.lArr=n.Leftarrow=t(r,"\\Leftarrow ","&lArr;");n.harr=n.lrarr=n.leftrightarrow=t(r,"\\leftrightarrow ","&harr;");n.iff=t(e,"\\Leftrightarrow ","&hArr;");n.hArr=n.lrArr=n.Leftrightarrow=t(r,"\\Leftrightarrow ","&hArr;");n.Re=n.Real=n.real=t(r,"\\Re ","&real;");n.Im=n.imag=n.image=n.imagin=n.imaginary=n.Imaginary=t(r,"\\Im ","&image;");n.part=n.partial=t(r,"\\partial ","&part;");n.inf=n.infin=n.infty=n.infinity=t(r,"\\infty ","&infin;");n.triangle=t(r,"\\triangle ","&#8710;");n.alef=n.alefsym=n.aleph=n.alephsym=t(r,"\\aleph ","&alefsym;");n.xist=n.xists=n.exist=n.exists=t(r,"\\exists ","&exist;");n.nexists=t(r,"\\nexists ","&#8708;");n.and=n.land=n.wedge=t(r,"\\wedge ","&and;");n.or=n.lor=n.vee=t(r,"\\vee ","&or;");n.o=n.O=n.empty=n.emptyset=n.oslash=n.Oslash=n.nothing=n.varnothing=t(e,"\\varnothing ","&empty;");n.cup=n.union=t(e,"\\cup ","&cup;");n.cap=n.intersect=n.intersection=t(e,"\\cap ","&cap;");n.deg=n.degree=t(r,"^\\circ ","&deg;");n.ang=n.angle=t(r,"\\angle ","&ang;");n.sphericalangle=t(r,"\\sphericalangle ","&#8738;");n.measuredangle=t(r,"\\measuredangle ","&#8737;");ui=f(d,function(n,t){n.init=function(n){t.init.call(this,"\\"+n+" ","<span>"+n+"<\/span>")};n.respace=function(){this.jQ[0].className=this[u]instanceof b||this[u]instanceof st?"":"non-italicized-function"}});n.ln=n.lg=n.log=n.span=n.proj=n.det=n.dim=n.min=n.max=n.mod=n.lcm=n.gcd=n.gcf=n.hcf=n.lim=ui,function(){var t=["sin","cos","tan","sec","cosec","csc","cotan","cot"];for(var i in t)n[t[i]]=n[t[i]+"h"]=n["a"+t[i]]=n["arc"+t[i]]=n["a"+t[i]+"h"]=n["arc"+t[i]+"h"]=ui}();var tt=function(){function v(n){var t=p();return n.adopt(t,0,0),t}function h(n){for(var t=n[0]||p(),i=1;i<n.length;i+=1)n[i].children().adopt(t,t.ends[u],0);return t}var i=o.string,t=o.regex,y=o.letter,w=o.any,f=o.optWhitespace,b=o.succeed,c=o.fail,k=y.map(a),d=t(/^[^${}\\_^]/).map(r),g=t(/^[^\\a-eg-zA-Z]/).or(i("\\").then(t(/^[a-z]+/i).or(t(/^\s+/).result(" ")).or(w))).then(function(t){var i=n[t];return i?i(t).parser():c("unknown command: \\"+t)}),nt=t(/^\\begin{array}\{(.*?)\}/).then(t(/^(.*?)\\end{array}/)).then(function(t){for(var e,t,h,c=t.replace(/\\end{array}/,""),r=n.matrix(),f=[],s=c.split("\\\\"),i=0;i<s.length;i++)for(e=s[i].split("&"),t=0;t<e.length;t++)h=tt.parse(e[t]),f.push(h);for(MatrixSize(s.length,e.length),r.blocks=f,i=0;i<f.length;i+=1)f[i].adopt(r,r.ends[u],0);return o.succeed(r)}),it=nt.or(g).or(k).or(d),rt=i("{").then(function(){return l}).skip(i("}")),e=f.then(rt.or(it.map(v))),l=e.many().map(h).skip(f),ut=i("[").then(e.then(function(n){return n.join("latex")!=="]"?b(n):c()}).many().map(h).skip(f)).skip(i("]")),s=l;return s.block=e,s.optBlock=ut,s}(),gi=f(kt,function(t){function e(n,t){var e,r,o,s;if(n[u][t])n.insAtLeftEnd(n[u][t]);else if(n[i][t])n.insAtRightEnd(n[i][t]);else{e=n.parent;do{if(r=e[t],r&&(typeof r=="function"&&(r=e[t](n)),r===!1||r instanceof p)){n.upDownCache[e.id]=kt(n.parent,n[i],n[u]);r instanceof p&&(o=n.upDownCache[r.id],o?o[u]?n.insLeftOf(o[u]):n.insAtRightEnd(o.parent):(s=f(n).left,n.insAtRightEnd(r),n.seekHoriz(s,r)));break}e=e.parent.parent}while(e)}return n.clearSelection().show()}function f(n){var t=n.jQ.removeClass("cursor").offset();return n.jQ.addClass("cursor"),t}function r(n){n.upDownCache={}}t.init=function(n){this.parent=this.root=n;var t=this.jQ=this._jQ=s('<span class="cursor">&zwj;<\/span>');this.blink=function(){t.toggleClass("blink")};this.upDownCache={}};t.show=function(){return this.jQ=this._jQ.removeClass("blink"),"intervalId"in this?clearInterval(this.intervalId):(this[u]?this.selection&&this.selection.ends[i][i]===this[i]?this.jQ.insertBefore(this.selection.jQ):this.jQ.insertBefore(this[u].jQ.first()):this.jQ.appendTo(this.parent.jQ),this.parent.focus()),this.intervalId=setInterval(this.blink,500),this};t.hide=function(){return"intervalId"in this&&clearInterval(this.intervalId),delete this.intervalId,this.jQ.detach(),this.jQ=s(),this};t.withDirInsertAt=function(n,t,i,r){var u=this.parent;this.parent=t;this[n]=i;this[-n]=r;u.blur()};t.insDirOf=function(n,t){return k(n),this.withDirInsertAt(n,t.parent,t[n],t),this.parent.jQ.addClass("hasCursor"),this.jQ.insDirOf(n,t.jQ),this};t.insLeftOf=function(n){return this.insDirOf(i,n)};t.insRightOf=function(n){return this.insDirOf(u,n)};t.insAtDirEnd=function(n,t){return k(n),this.withDirInsertAt(n,t,0,t.ends[n]),n===i&&t.textarea?this.jQ.insDirOf(-n,t.textarea):this.jQ.insAtDirEnd(n,t.jQ),t.focus(),this};t.insAtLeftEnd=function(n){return this.insAtDirEnd(i,n)};t.insAtRightEnd=function(n){return this.insAtDirEnd(u,n)};t.hopDir=function(n){return k(n),this.jQ.insDirOf(n,this[n].jQ),this[-n]=this[n],this[n]=this[n][n],this};t.hopLeft=function(){return this.hopDir(i)};t.hopRight=function(){return this.hopDir(u)};t.moveDirWithin=function(n,t){if(k(n),this[n])this[n].ends[-n]?this.insAtDirEnd(-n,this[n].ends[-n]):this.hopDir(n);else{if(this.parent===t)return;this.parent[n]?this.insAtDirEnd(-n,this.parent[n]):this.insDirOf(n,this.parent.parent)}};t.moveLeftWithin=function(n){return this.moveDirWithin(i,n)};t.moveRightWithin=function(n){return this.moveDirWithin(u,n)};t.moveDir=function(n){return k(n),r(this),this.selection?this.insDirOf(n,this.selection.ends[n]).clearSelection():this.moveDirWithin(n,this.root),this.show()};t.moveLeft=function(){return this.moveDir(i)};t.moveRight=function(){return this.moveDir(u)};t.moveUp=function(){return e(this,"up")};t.moveDown=function(){return e(this,"down")};t.seek=function(n,t){r(this);var u,f,i=this.clearSelection().show();return n.hasClass("empty")?(i.insAtLeftEnd(h[n.attr(l)]),i):(u=h[n.attr(fi)],u instanceof d)?(n.outerWidth()>2*(t-n.offset().left)?i.insLeftOf(u):i.insRightOf(u),i):(u||(f=h[n.attr(l)],f||(n=n.parent(),u=h[n.attr(fi)],u||(f=h[n.attr(l)],f||(f=i.root)))),u?i.insRightOf(u):i.insAtRightEnd(f),i.seekHoriz(t,i.root))};t.seekHoriz=function(n,t){var r=this,u=f(r).left-n,e;do r.moveLeftWithin(t),e=u,u=f(r).left-n;while(u>0&&(r[i]||r.parent!==t));return-u>e&&r.moveRightWithin(t),r};t.writeLatex=function(n){var t=this;r(t);t.show().deleteSelection();var e=o.all,s=o.eof,f=tt.skip(s).or(e.result(!1)).parse(n);return f&&(f.children().adopt(t.parent,t[i],t[u]),h.jQize(f.join("html")).insertBefore(t.jQ),t[i]=f.ends[u],f.finalizeInsert(),t.parent.bubble("redraw")),this.hide()};t.write=function(n){var t=this.prepareWrite();return this.insertCh(n,t)};t.insertCh=function(n,t){return this.parent.write(this,n,t),this};t.insertCmd=function(t,r){var u=n[t];return u?(u=u(t),r&&u.replaces(r),u.createLeftOf(this)):(u=yt(),u.replaces(t),u.ends[i].focus=function(){return delete this.focus,this},u.createLeftOf(this),this.insRightOf(u),r&&r.remove()),this};t.unwrapGramp=function(){var n=this.parent.parent,t=n.parent,f=n[u],e=this,r=n[i];if(n.disown().eachChild(function(i){i.isEmpty()||(i.children().adopt(t,r,f).each(function(t){t.jQ.insertBefore(n.jQ.first())}),r=i.ends[u])}),!this[u])if(this[i])this[u]=this[i][u];else while(!this[u])if(this.parent=this.parent[u],this.parent)this[u]=this.parent.ends[i];else{this[u]=n[u];this.parent=t;break}this[u]?this.insLeftOf(this[u]):this.insAtRightEnd(t);n.jQ.remove();n[i]&&n[i].respace();n[u]&&n[u].respace()};t.deleteDir=function(n){if(k(n),r(this),this.show(),!this.deleteSelection())if(this[n])this[n].isEmpty()?this[n]=this[n].remove()[n]:this.selectDir(n);else if(this.parent!==this.root){if(this.parent.parent.isEmpty())return this.insDirOf(-n,this.parent.parent).deleteDir(n);this.unwrapGramp()}return this[i]&&this[i].respace(),this[u]&&this[u].respace(),this.parent.bubble("redraw"),this};t.backspace=function(){return this.deleteDir(i)};t.deleteForward=function(){return this.deleteDir(u)};t.selectFrom=function(n){var f=this,e=n,o,s,r,t,c,h;n:for(;;){for(o=this;o!==f.parent.parent;o=o.parent.parent)if(o.parent===e.parent){r=o;t=e;break n}for(s=n;s!==e.parent.parent;s=s.parent.parent)if(f.parent===s.parent){r=f;t=s;break n}f.parent.parent&&(f=f.parent.parent);e.parent.parent&&(e=e.parent.parent)}if(r[u]!==t){for(h=r;h;h=h[u])if(h===t[i]){c=!0;break}c||(c=t,t=r,r=c)}this.hide().selection=ci(r[i][u]||r.parent.ends[i],t[u][i]||t.parent.ends[u]);this.insRightOf(t[u][i]||t.parent.ends[u]);this.root.selectionChanged()};t.selectDir=function(n){if(k(n),r(this),this.selection)if(this.selection.ends[n]===this[-n])this[n]?this.hopDir(n).selection.extendDir(n):this.parent!==this.root&&this.insDirOf(n,this.parent.parent).selection.levelUp();else{if(this.hopDir(n),this.selection.ends[n]===this.selection.ends[-n]){this.clearSelection().show();return}this.selection.retractDir(n)}else{if(this[n])this.hopDir(n);else{if(this.parent===this.root)return;this.insDirOf(n,this.parent.parent)}this.hide().selection=ci(this[-n])}this.root.selectionChanged()};t.selectLeft=function(){return this.selectDir(i)};t.selectRight=function(){return this.selectDir(u)};t.prepareMove=function(){return r(this),this.show().clearSelection()};t.prepareEdit=function(){return r(this),this.show().deleteSelection()};t.prepareWrite=function(){return r(this),this.show().replaceSelection()};t.clearSelection=function(){return this.selection&&(this.selection.clear(),delete this.selection,this.root.selectionChanged()),this};t.deleteSelection=function(){return this.selection?(this[i]=this.selection.ends[i][i],this[u]=this.selection.ends[u][u],this.selection.remove(),this.root.selectionChanged(),delete this.selection):!1};t.replaceSelection=function(){var n=this.selection;return n&&(this[i]=n.ends[i][i],this[u]=n.ends[u][u],delete this.selection),n}}),ci=f(at,function(n,t){n.init=function(){var n=this;t.init.apply(n,arguments);n.jQwrap(n.jQ)};n.jQwrap=function(n){this.jQ=n.wrapAll('<span class="selection"><\/span>').parent()};n.adopt=function(){return this.jQ.replaceWith(this.jQ=this.jQ.children()),t.adopt.apply(this,arguments)};n.clear=function(){return this.jQ.replaceWith(this.jQ.children()),this};n.levelUp=function(){var n=this,t=n.ends[i]=n.ends[u]=n.ends[u].parent.parent;return n.clear().jQwrap(t.jQ),n};n.extendDir=function(n){return k(n),this.ends[n]=this.ends[n][n],this.ends[n].jQ.insAtDirEnd(n,this.jQ),this};n.extendLeft=function(){return this.extendDir(i)};n.extendRight=function(){return this.extendDir(u)};n.retractDir=function(n){k(n);this.ends[-n].jQ.insDirOf(-n,this.jQ);this.ends[-n]=this.ends[-n][n]};n.retractRight=function(){return this.retractDir(u)};n.retractLeft=function(){return this.retractDir(i)}});g.fn.mathquill=function(n,t){var r,u;switch(n){case"redraw":return this.each(function(){var n=s(this).attr(l),t=n&&h[n];t&&function i(n){n.eachChild(i);n.redraw&&n.redraw()}(t)});case"revert":return this.each(function(){var t=s(this).attr(l),n=t&&h[t];n&&n.revert&&n.revert()});case"latex":return arguments.length>1?this.each(function(){var n=s(this).attr(l),i=n&&h[n];i&&i.renderLatex(t)}):(r=s(this).attr(l),u=r&&h[r],u&&u.latex());case"text":return r=s(this).attr(l),u=r&&h[r],u&&u.text();case"html":return this.html().replace(/ ?hasCursor|hasCursor /,"").replace(/ class=(""|(?= |>))/g,"").replace(/<span class="?cursor( blink)?"?><\/span>/i,"").replace(/<span class="?textarea"?><textarea><\/textarea><\/span>/i,"");case"write":if(arguments.length>1)return this.each(function(){var n=s(this).attr(l),i=n&&h[n],r=i&&i.cursor;r&&r.writeLatex(t).parent.blur()});case"cmd":if(arguments.length>1)return this.each(function(){var r=s(this).attr(l),u=r&&h[r],n=u&&u.cursor,i;n&&(i=n.prepareWrite(),/^\\[a-z]+$/i.test(t)?n.insertCmd(t.slice(1),i):n.insertCh(t,i),n.hide().parent.blur())});case"color":if(arguments.length>1)return this.each(function(){var u=s(this).attr(l),n=u&&h[u],f=n&&n.cursor,e=f.selection,o=f.selection.latex(),r;e.ends[i].ctrlSeq="_!_@"+e.ends[i].ctrlSeq;r=n.latex();r=r.replace("_!_@"+o,"\\color{"+t+"}{"+o+"}");n.renderLatex(r)});case"bold":return console.log("Inside bold"),this.each(function(){var r=s(this).attr(l),n=r&&h[r],u=n&&n.cursor,f=u.selection,e=u.selection.latex(),t;f.ends[i].ctrlSeq="_!_@"+f.ends[i].ctrlSeq;t=n.latex();t=t.replace("_!_@"+e,"\\textbf{"+e+"}");n.renderLatex(t)});case"italic":return this.each(function(){var r=s(this).attr(l),n=r&&h[r],u=n&&n.cursor,f=u.selection,e=u.selection.latex(),t;f.ends[i].ctrlSeq="_!_@"+f.ends[i].ctrlSeq;t=n.latex();t=t.replace("_!_@"+e,"\\emph{"+e+"}");n.renderLatex(t)});default:var f=n==="textbox",e=f||n==="editable",o=f?ai:ot;return this.each(function(){oi(s(this),o(),f,e)})}};g(function(){g(".mathquill-editable:not(.mathquill-rendered-math)").mathquill("editable");g(".mathquill-textbox:not(.mathquill-rendered-math)").mathquill("textbox");g(".mathquill-embedded-latex").mathquill()})})();
/*
//# sourceMappingURL=mathquill.min.js.map
*/